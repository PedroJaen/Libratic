<mat-toolbar>
    <a href="https://www.themoviedb.org/" target="_blank" matTooltip="Patrocinado por The Movie DB">
        <img class="w-25" src="../../../assets/movieDB_logo.png">
    </a>

    <div class="spacer"></div>
    <button mat-icon-button matTooltip="Crear" (click)="newMovie()" color="primary" *ngIf="isAdmin">
        <i class="fas fa-plus"></i>
        <i class="fas fa-film"></i>
    </button>
</mat-toolbar>

<div class="container-fluid mt-3">
    <mat-accordion>
        <mat-expansion-panel *ngFor="let item of movies">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <span class="mr-2"><b>{{item.title}}</b></span>
                    <span>{{item.release_date}}</span>
                </mat-panel-title>

                <button mat-icon-button matTooltip="Añadir deseado"
                    (click)="addMovieWished(item.id); $event.stopPropagation()" color="primary"
                    *ngIf="isLoged && !isAdmin">
                    <i class="fas fa-hand-holding-heart"></i>
                </button>
                <button mat-icon-button matTooltip="Añadir favorito"
                    (click)="addMovieFavoutire(item.id); $event.stopPropagation()" color="primary"
                    *ngIf="isLoged && !isAdmin">
                    <i class="fas fa-heart"></i>
                </button>
                <button mat-icon-button matTooltip="Editar" (click)="editMovie(item); $event.stopPropagation()"
                    color="primary" *ngIf="isAdmin">
                    <i class="fas fa-pen"></i>
                </button>
                <button mat-icon-button matTooltip="Eliminar" (click)="deleteMovie(item.id); $event.stopPropagation()"
                    color="primary" *ngIf="isAdmin">
                    <i class="fas fa-minus"></i>
                </button>
            </mat-expansion-panel-header>

            <div class="container-fluid">
                <div class="row">
                    <div class="col-2">
                        <div class="row">
                            <span *ngIf="item.poster_path">
                                <img [src]="item.poster_path" class="w-100">
                            </span>

                            <span *ngIf="!item.poster_path" class="content-fluid">
                                <i class="fas fa-film fa-4x"></i>
                            </span>
                        </div>

                        <div class="row justify-content-end mt-2" *ngIf="item.homepage">
                            <a [href]="item.homepage" target="_blank">
                                <button mat-raised-button type="button" color="primary">Web oficial</button>
                            </a>
                        </div>

                        <div class="row justify-content-end mt-2" *ngIf="item.url">
                            <a [href]="item.url" target="_blank">
                                <button mat-raised-button type="button" color="primary">Entrada en The Movie DB</button>
                            </a>
                        </div>

                    </div>

                    <div class="col">
                        <div class="row" *ngIf="item.title">
                            <div class="col">
                                <b>Título: </b>
                                <span>{{item.title}}</span>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.tagline">
                            <div class="col">
                                <b>Lema: </b>
                                <span>{{item.tagline}}</span>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.release_date || item.runtime || item.vote_average">
                            <div class="col-auto" *ngIf="item.release_date">
                                <b>Fecha de estreno: </b>
                                <span>{{item.release_date}}</span>
                            </div>

                            <div class="col-auto" *ngIf="item.runtime">
                                <b>Duración: </b>
                                <span>{{item.runtime}}</span>
                            </div>

                            <div class="col-auto" *ngIf="item.vote_average">
                                <b>Puntuación: </b>
                                <span>{{item.vote_average}}</span>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.overview">
                            <div class="col">
                                <b>Resumen: </b>
                                <span>{{item.overview}}</span>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.genres">
                            <div class="col">
                                <b>Géneros: </b>
                                <mat-chip-list>
                                    <mat-chip *ngFor="let genre of item.genres">{{genre}}</mat-chip>
                                </mat-chip-list>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.production_companies">
                            <div class="col">
                                <b>Productoras: </b>
                                <mat-chip-list>
                                    <mat-chip *ngFor="let company of item.production_companies">{{company}}</mat-chip>
                                </mat-chip-list>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.cast">
                            <div class="col">
                                <b>Actores: </b>
                                <mat-chip-list>
                                    <mat-chip *ngFor="let actor of item.cast">{{actor.character}}: {{actor.name}}
                                    </mat-chip>
                                </mat-chip-list>
                            </div>
                        </div>

                        <div class="row mt-2" *ngIf="item.crew">
                            <div class="col">
                                <b>Personal: </b>
                                <mat-chip-list>
                                    <mat-chip *ngFor="let employee of item.crew">{{employee.job}}: {{employee.name}}
                                    </mat-chip>
                                </mat-chip-list>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </mat-expansion-panel>
    </mat-accordion>
</div>